---
title: "exuber package"
author: "Simon Spavound"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette documents how to use the exuber package for analysing time series data.

Let's start by loading the package:

```{r load_libraries, message=FALSE, warning=FALSE}
library(exuber)
```

## Load data

This vignette will demonstrate the features of the exuber package by replicating the empirical example of Philips, Shi and Yu (2015). They apply recursive unit root testing methods to the S and P 500 Price Dividend ratio.

<!-- this will need a lot of modification once I have worked out how to correctly attach the data file --> 

```{r load data}
dat <- sp500ratio
sp.500.ratio <- dat$sp.500.ratio
sp.500.ratio <- ts(sp.500.ratio, start = c(1871, 1), frequency = 12)
```

Lets have a look at the data:

<!-- need to read up how to correctly format these graphs -->

```{r plot data}
plot.ts(sp.500.ratio, xlab = "", ylab = "")
```

## Run RADF()

```{r radf}
test <- radf(sp.500.ratio)
```

## Calculate Critical Values

WARNING: This will take a long time to evaluate, even on very fast computers with many cores. It is recommended for testing purposes that you reduce number of repetitions (nrep) to something small, i.e. 10.

```{r crit values, eval = FALSE}
crit <- mc_cv(NROW(sp.500.ratio), nrep = 2000, parallel = F)
```

```{r crit values execute, echo = FALSE}
crit <- mc_cv(NROW(sp.500.ratio), nrep = 10, parallel = F)
```

## Report

```{r report,  eval = FALSE}
report(test, crit)
```

This should result in an output like this:

```
 Recursive Unit Root Testing Summary 
 --------------------------------------------- 
 H0: Unit root  
 H1: Explosive root 
 ---------------------------------------------
 Critical values are generated by: Monte Carlo 
 Number of iterations: 10 
 Minimum window is set to: 90 
 Lag is set to: 0 
 ---------------------------------------------
 Series 1 
          tstat        90%       95%       99%
ADF   -1.164369 -0.5330635 0.1436561 0.6850319
SADF   3.461896  1.1946689 1.2635113 1.3185852
GSADF  4.160298  1.8733424 1.9338541 1.9822635
```

## Plot

<!-- see issue tracker cannot modify x labels -->

```{r plot,  eval = FALSE}
plot(test, crit)
```

```{r plot show}
plot(test, crit)
```
